<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤ä¹ ä»Šå¤©çš„å•è¯</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: lightcyan;
        }
        table {
            margin: 20px auto;
            border-collapse: collapse;
            width: 90%;
            font-size: 18px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .column1 { width: 10%; }
        .column2 { width: 20%; }
        .column3 { width: 15%; }
        .column4 { width: 40%; }
        .column5 { width: 15%; }
        .toggle-button {
            padding: 5px 10px;
            border: none;
            color: white;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1 id="title">éœ€è¦å¤ä¹ çš„å•è¯åˆ—è¡¨</h1>
    <table id="wordTable">
        <thead>
            <tr>
                <th class="column1">åºåˆ—å·</th>
                <th class="column2">å•è¯</th>
                <th class="column3">çŠ¶æ€</th>
                <th class="column4">è§£é‡Š</th>
                <th class="column5">å®Œæˆå¤ä¹ ?</th>
            </tr>
        </thead>
        <tbody>
            <!-- åŠ¨æ€å¡«å……å•è¯åˆ—è¡¨ -->
        </tbody>
    </table>

    <button id="startTestButton" disabled>å¼€å§‹æµ‹è¯•</button>

    <script>
        let todayWordList = JSON.parse(localStorage.getItem("todayWordList")) || [];

        function renderTable() {
            const tableBody = document.getElementById('wordTable').querySelector('tbody');
            tableBody.innerHTML = '';

            todayWordList.forEach((word, index) => {
                const row = document.createElement('tr');

                // åºåˆ—å·
                const indexCell = document.createElement('td');
                indexCell.textContent = index + 1;
                row.appendChild(indexCell);

                // å•è¯åŠå‘éŸ³æŒ‰é’®
                const wordCell = document.createElement('td');
                wordCell.textContent = word.word;
                const playIcon = document.createElement('span');
                playIcon.innerHTML = ' ğŸ”Š';
                playIcon.style.cursor = 'pointer';
                playIcon.title = 'æ’­æ”¾';
                playIcon.onclick = () => playAudio(word.word);
                wordCell.appendChild(playIcon);
                row.appendChild(wordCell);

                // çŠ¶æ€
                const statusCell = document.createElement('td');
                statusCell.textContent = word.status || 'æœªçŸ¥';
                row.appendChild(statusCell);

                // è§£é‡Š
                const explanationCell = document.createElement('td');
                explanationCell.textContent = word.explanation || 'æš‚æ— è§£é‡Š';
                row.appendChild(explanationCell);

                // å¤ä¹ çŠ¶æ€æŒ‰é’®
                const resultCell = document.createElement('td');
                const toggleButton = document.createElement('button');
                toggleButton.textContent = 'æœªå®Œæˆ';
                toggleButton.style.backgroundColor = 'red';
                toggleButton.classList.add('toggle-button');
                toggleButton.onclick = () => {
                    if (toggleButton.textContent === 'æœªå®Œæˆ') {
                        toggleButton.textContent = 'å®Œæˆ';
                        toggleButton.style.backgroundColor = 'green';
                    } else {
                        toggleButton.textContent = 'æœªå®Œæˆ';
                        toggleButton.style.backgroundColor = 'red';
                    }
                    checkCompletion();
                };
                resultCell.appendChild(toggleButton);
                row.appendChild(resultCell);

                tableBody.appendChild(row);
                
                // è®°å½•è¡¨æ ¼åŠ è½½æ—¶é—´
                const examTimeInitial = new Date().toLocaleString('en-US', { timeZone: 'Asia/Hong_Kong' });
                localStorage.setItem('examTimeInitial', examTimeInitial);

            });
        }

        function playAudio(word) {
            const utterance = new SpeechSynthesisUtterance(word);
            utterance.lang = 'zh-CN';
            utterance.rate = 0.8;
            speechSynthesis.speak(utterance);
        }

        function checkCompletion() {
            const allCompleted = Array.from(document.querySelectorAll('.toggle-button'))
                .every(button => button.textContent === 'å®Œæˆ');
            document.getElementById('startTestButton').disabled = !allCompleted;
        }

        document.getElementById('startTestButton').onclick = () => {
            window.location.href = 'cntesting.html';
        };

        renderTable();
    </script>
</body>
</html>
